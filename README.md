# Документация к игре Тетрис

Игра Тетрис, реализованная в данном проекте, представляет собой классическую головоломку с падающими фигурами, которые игроки должны размещать в ряды, чтобы очистить игровое поле и набирать очки. Проект разработан с использованием парадигмы разделения на слои, обеспечивая гибкую архитектуру и легкость в поддержке и расширении функционала.

## Обзор архитектуры

Проект структурирован на несколько слоев, каждый из которых отвечает за определенные аспекты игры:

- `BusinessLogic`: Содержит основные механики игры, правила и управление состоянием.
- `DataAccess`: Отвечает за сохранение и загрузку игрового состояния и результатов игроков.
- `Presentation`: Включает в себя классы для взаимодействия с пользователем и отображения состояния игры.
- `Exceptions`: Определяет пользовательские исключения для обработки специфических игровых событий, таких как завершение игры или выход в главное меню.

Каждый слой имеет четко определенные обязанности и взаимодействует с другими слоями через определенные интерфейсы и классы, что облегчает масштабирование и модификацию игры.

## Описание слоев

### Слой `BusinessLogic`
Описывает логику и правила игры, включая управление фигурами, игровым полем и счетом игроков.

### Слой `DataAccess`
Отвечает за сохранение и загрузку состояний игры и рейтингов игроков, используя файловую систему для хранения данных.

### Слой `Presentation`
Обеспечивает взаимодействие с пользователем, отображение игрового поля, текущего счета и меню, предоставляя команды для управления игровым процессом.

### Слой `Exceptions`
Содержит определения исключений для контроля особых условий игрового процесса, таких как необходимость завершения игры или возвращения в главное меню.

Каждый слой играет важную роль в обеспечении плавного и интуитивно понятного игрового опыта, а их разделение позволяет разработчикам фокусироваться на конкретных задачах, не заботясь о внутренних деталях других частей системы.

## Рекомендации по использованию документации

Документация предоставляет информацию о каждом слое, его компонентах и методах. Для полного понимания работы игры и ее расширения рекомендуется ознакомиться с документацией каждого слоя и исходным кодом, что позволит быстро вносить изменения и добавлять новые возможности в игру.



# Слой Бизнес-Логики

Слой бизнес-логики игры Тетрис отвечает за основные механики игры, управление состоянием и правила взаимодействия. Он отделён от презентационного слоя, чтобы обеспечить чёткое разграничение между логикой игры и тем, как она отображается пользователю.

## Компоненты

### Cell
Представляет собой одну ячейку на игровом поле Тетриса.

- `X`: Горизонтальная позиция ячейки.
- `Y`: Вертикальная позиция ячейки.
- `IsFilled`: Указывает, занята ли ячейка.
- `Color`: Цвет ячейки, представленный в виде строки.

### Figure
Определяет форму, размер и поведение фигур Тетриса.

- Динамически рассчитывает свой размер на основе своей формы.
- Поддерживает клонирование для создания новых экземпляров.
- Может проверять, возможно ли вращение в пределах игрового поля.
- Предоставляет метод для поворота фигуры вправо.
- `AllFigures`: Список всех доступных в игре шаблонов фигур.

### Game
Управляет общим состоянием игры, включая игровой цикл и взаимодействие с пользователем.

- Обрабатывает инициализацию игры и начало новой игры.
- Поддерживает сохранение и загрузку состояний игры.
- Обрабатывает пользовательский ввод для управления игровыми фигурами.
- Отрисовывает состояние игры с помощью обработчика UI.
- Управляет игровым циклом и таймингом движения фигур.

### GameField
Представляет игровое поле и его текущее состояние.

- `Width`: Ширина игрового поля.
- `Height`: Высота игрового поля.
- Содержит методы для перемещения и вращения фигур, проверки заполненных линий и обработки очков.
- Управляет появлением и фиксацией фигур на игровом поле.

### Player
Содержит информацию о игроке, включая его имя и счет.

- `Name`: Имя игрока.
- `Score`: Текущий счет игрока.

## Использование

Компоненты бизнес-логики используются презентационным слоем для создания интерактивного игрового опыта. Каждый компонент отвечает за отдельный аспект функциональности игры, и вместе они управляют состоянием и правилами игры.

Класс `Game` действует как точка входа в логику игры, координируя игровой цикл, пользовательский ввод и поток игры.

## Примечания

- Слой `business logic` не обрабатывает непосредственно отрисовку пользовательского интерфейса. Он предоставляет данные и правила, в то время как `presentation layer` занимается фактическим рисованием и взаимодействием с пользователем.
- Обработка исключений интегрирована в игровую логику для управления сценариями окончания игры и действиями пользователей, такими как выход в главное меню.





# Слой `DataAccess`

Слой `DataAccess` в архитектуре приложения Тетрис отвечает за взаимодействие с постоянным хранилищем данных. Он реализует механизмы для сохранения и загрузки состояний игры, а также для ведения таблицы рекордов игроков.

## Компоненты

### GameState
Класс `GameState` хранит данные о текущем состоянии игрового поля, активной фигуре, времени последнего перемещения и очках игрока.

### GameStateSaver
Класс `GameStateSaver` предоставляет методы для сохранения состояния игры в файл и загрузки из него, используя формат JSON.

### ScoreBoard
Класс `ScoreBoard` отвечает за хранение и обновление рекордов игроков. Позволяет добавлять новые результаты, обновлять существующие и выводить список рекордов.

## Использование

Классы слоя `DataAccess` могут использоваться любым компонентом приложения, требующим сохранения или загрузки данных. `GameStateSaver` используется для управления сохраненными играми, в то время как `ScoreBoard` применяется для работы с таблицей лидеров.

## Примечания

- Слой `DataAccess` не должен содержать бизнес-логику или логику представления.
- Все операции с файлами оборачиваются в блоки try-catch для обработки возможных исключений, связанных с чтением/записью файлов.






# Слой `Exceptions`

Слой `Exceptions` содержит определения пользовательских исключений для приложения Тетрис. Эти исключения используются для контроля потока выполнения программы в особых ситуациях, таких как выход в главное меню или окончание игры.

## Компоненты

### ExitToMainMenuException
Класс `ExitToMainMenuException` используется для сигнализирования о необходимости прервать текущий игровой процесс и вернуться в главное меню. Наследуется от стандартного класса `Exception`.

### GameOverException
Класс `GameOverException` предназначен для обработки ситуации, когда игра заканчивается (игрок проиграл). Содержит дополнительное свойство `Score`, позволяющее передать очки, набранные игроком на момент окончания игры.

## Использование

Пользовательские исключения могут выбрасываться бизнес-логикой приложения для того, чтобы управлять особыми состояниями игры. `ExitToMainMenuException` может быть использовано для мгновенного выхода из игрового цикла, а `GameOverException` — для передачи управления обработчику окончания игры с сохранением результата игрока.

## Примечания

- Классы исключений минимально необходимы для описания особых состояний игры и не содержат сложной логики.
- Использование пользовательских исключений позволяет явно определить и обработать особые сценарии игры, отличая их от других исключительных ситуаций.




# Слой `Presentation`

Слой `Presentation` отвечает за взаимодействие с пользователем и отображение состояния игры Тетрис. Он включает в себя пользовательские меню и обработчики UI, которые представляют игровые данные в удобной для понимания форме.

## Компоненты

### GameMenu
Класс `GameMenu` обеспечивает интерактивное меню во время игры и главное меню, позволяя пользователю выбирать различные игровые опции.

#### Методы
- `InGameMenu()`: Отображает меню во время игры с опциями продолжить, сохранить, загрузить игру, посмотреть таблицу лидеров или выйти в главное меню.
- `MainMenu()`: Отображает главное меню с опциями начать новую игру, загрузить игру, посмотреть таблицу лидеров или выйти из игры.
- `DisplayScoreBoard()`: Вспомогательный метод для отображения таблицы лидеров.

### UiHandler
Класс `UiHandler` отвечает за отрисовку игрового поля, текущей фигуры и следующей фигуры, а также отображение текущего счёта игры.

#### Методы
- `Update()`: Обновляет данные, необходимые для отрисовки, такие как игровое поле, текущая и следующая фигуры.
- `Render()`: Отрисовывает текущее состояние игрового поля, текущей и следующей фигуры, а также отображает текущий счёт игры.
- `GetColor()`: Вспомогательный метод для преобразования строки в соответствующий цвет консоли.

## Использование

Слой `Presentation` используется для отображения игровой информации и обработки пользовательских действий через меню. Этот слой напрямую взаимодействует с классами бизнес-логики и данных для обновления и отображения игрового состояния.

Классы `GameMenu` и `UiHandler` работают совместно, чтобы предоставить пользователю информацию о состоянии игры и принимать его выбор для управления игровым процессом.

## Примечания

- Слой `Presentation` не содержит бизнес-логику игры; его задача — представить данные пользователю и принять от него команды.
- Отрисовка интерфейса происходит в консоли с использованием символов и цветов для представления различных элементов игры.

